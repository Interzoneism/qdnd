{
  "name": "Extended Combat Scenario",
  "description": "Multi-round BG3-style combat: buff phase, focus fire, cleanup, victory",
  "defaultScenarioPath": "res://Data/Scenarios/minimal_combat.json",
  "tests": [
    {
      "name": "bg3_round1_opening",
      "description": "BG3 Round 1: Fighter uses Shout_ActionSurge (buff), then attacks Goblin",
      "commands": [
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Shout_ActionSurge", "targetId": "ally_1" },
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_MainHandAttack", "targetId": "enemy_1" },
        { "type": "EndTurn" }
      ],
      "assertions": [
        { "combatantId": "ally_1", "field": "ActiveStatuses", "operator": "contains", "expectedValue": "inspired" },
        { "combatantId": "ally_1", "field": "HasAction", "operator": "equals", "expectedValue": "False" },
        { "combatantId": "ally_1", "field": "HasBonusAction", "operator": "equals", "expectedValue": "False" },
        { "combatantId": "enemy_1", "field": "CurrentHP", "operator": "changed", "expectedValue": null },
        { "combatantId": null, "field": "CurrentCombatantId", "operator": "equals", "expectedValue": "enemy_1" }
      ]
    },
    {
      "name": "bg3_poison_debuff_combo",
      "description": "BG3 Strategy: Apply poison debuff to weaken enemy attack rolls",
      "commands": [
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_PoisonSpray", "targetId": "enemy_1" }
      ],
      "assertions": [
        { "combatantId": "enemy_1", "field": "ActiveStatuses", "operator": "contains", "expectedValue": "poisoned" },
        { "combatantId": "enemy_1", "field": "AttackBonus", "operator": "equals", "expectedValue": "-2" },
        { "combatantId": "enemy_1", "field": "CurrentHP", "operator": "lessThan", "expectedValue": "20" }
      ]
    },
    {
      "name": "bg3_power_strike_burst",
      "description": "BG3 Burst: Use Target_MainHandAttack for maximum single-target damage",
      "commands": [
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_MainHandAttack", "targetId": "enemy_1" }
      ],
      "assertions": [
        { "combatantId": "enemy_1", "field": "CurrentHP", "operator": "lessThan", "expectedValue": "20" },
        { "combatantId": "ally_1", "field": "HasAction", "operator": "equals", "expectedValue": "False" }
      ]
    },
    {
      "name": "bg3_move_and_engage",
      "description": "BG3 Positioning: Move to engage distant Orc, preserve action for next turn",
      "commands": [
        { "type": "MoveTo", "actorId": "ally_1", "position": [5, 0, 1] },
        { "type": "EndTurn" }
      ],
      "assertions": [
        { "combatantId": "ally_1", "field": "PositionX", "operator": "equals", "expectedValue": "5" },
        { "combatantId": "ally_1", "field": "HasAction", "operator": "equals", "expectedValue": "True" },
        { "combatantId": null, "field": "CurrentCombatantId", "operator": "equals", "expectedValue": "enemy_1" }
      ]
    },
    {
      "name": "bg3_full_action_economy",
      "description": "BG3 Economy: Use bonus action buff, movement, AND action attack in same turn",
      "commands": [
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Shout_ActionSurge", "targetId": "ally_1" },
        { "type": "MoveTo", "actorId": "ally_1", "position": [0.5, 0, 0] },
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_MainHandAttack", "targetId": "enemy_1" }
      ],
      "assertions": [
        { "combatantId": "ally_1", "field": "HasAction", "operator": "equals", "expectedValue": "False" },
        { "combatantId": "ally_1", "field": "HasBonusAction", "operator": "equals", "expectedValue": "False" },
        { "combatantId": "ally_1", "field": "ActiveStatuses", "operator": "contains", "expectedValue": "inspired" },
        { "combatantId": "ally_1", "field": "RemainingMovement", "operator": "changed", "expectedValue": null },
        { "combatantId": "enemy_1", "field": "CurrentHP", "operator": "changed", "expectedValue": null }
      ]
    },
    {
      "name": "bg3_4round_sustained_combat",
      "description": "BG3 Full Fight: 4 rounds of player actions testing turn cycling and resource reset",
      "commands": [
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Shout_ActionSurge", "targetId": "ally_1" },
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_MainHandAttack", "targetId": "enemy_1" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_PoisonSpray", "targetId": "enemy_1" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_MainHandAttack", "targetId": "enemy_1" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_MainHandAttack", "targetId": "enemy_1" }
      ],
      "assertions": [
        { "combatantId": null, "field": "CurrentRound", "operator": "greaterThan", "expectedValue": "3" },
        { "combatantId": "enemy_1", "field": "CurrentHP", "operator": "lessThan", "expectedValue": "10" }
      ]
    },
    {
      "name": "bg3_focus_fire_strategy",
      "description": "BG3 Focus: Concentrate damage on high-priority target (Goblin)",
      "commands": [
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_MainHandAttack", "targetId": "enemy_1" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "EndTurn" },
        { "type": "UseAbility", "actorId": "ally_1", "abilityId": "Target_MainHandAttack", "targetId": "enemy_1" }
      ],
      "assertions": [
        { "combatantId": "enemy_1", "field": "CurrentHP", "operator": "lessThan", "expectedValue": "10" }
      ]
    }
  ]
}
