[0;32m[INFO][0m Using Godot: godot
[0;32m[INFO][0m Project dir: /home/martin/repos/qdnd
[0;32m[INFO][0m Running in FULL-FIDELITY mode (HUD, animations, visuals active)
[0;32m[INFO][0m Running auto-battle...
[0;36m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê[0m
[0;32m[INFO][0m Using existing display: :0
Godot Engine v4.6.stable.mono.official.89cea1439 - https://godotengine.org
Vulkan 1.4.305 - Forward+ - Using Device #0: Unknown - llvmpipe (LLVM 19.1.1, 256 bits)
libasound.so.2: cannot open shared object file: No such file or directory
libpulse.so.0: cannot open shared object file: No such file or directory
libpulse.so.0: cannot open shared object file: No such file or directory
libasound.so.2: cannot open shared object file: No such file or directory
WARNING: All audio drivers failed, falling back to the dummy driver.
     at: initialize (servers/audio/audio_server.cpp:247)

[ScenarioSelector] Found 23 scenarios
[CombatArena] === COMBAT ARENA INITIALIZING ===
[DebugFlag] IsAutoBattle = True
[DebugFlag] IsFullFidelity = True
[DebugFlag] SkipAnimations = False
[CombatArena] Full-fidelity mode: HUD, animations, and visuals will run normally
[CombatArena] Auto-battle CLI mode detected
[CombatArena] Auto-battle scenario: res://Data/Scenarios/ff_short_attrition.json
[CombatArena] Auto-battle seed override: 42
[CombatArena] Ground collision plane created (100x100m at Y=0)
[CombatArena] CombatContext created
[CombatContext] Registered service: CombatStateMachine
[CombatContext] Registered service: TurnQueueService
[CombatContext] Registered service: CommandService
[CombatContext] Registered service: CombatLog
[CombatContext] Registered service: ScenarioLoader
[Registry] Loaded from /home/martin/repos/qdnd/Data:
  - 7 abilities
  - 6 statuses
  - 23 scenarios
[INFO] [Registry] Dependencies: Checked 7 abilities, 6 statuses, 23 scenarios
[Registry] Validation complete: 0 errors, 0 warnings
[CombatContext] Registered service: DataRegistry
[CombatContext] Registered service: RulesEngine
[CombatContext] Registered service: StatusManager
[CombatContext] Registered service: EffectPipeline
[CombatContext] Registered service: TargetValidator
[CombatContext] Registered service: ReactionSystem
[CombatContext] Registered service: LOSService
[CombatContext] Registered service: HeightService
[CombatContext] Registered service: AIDecisionPipeline
[CombatContext] Registered service: MovementService
[CombatContext] Registered service: SurfaceManager
[CombatContext] Registered service: PresentationRequestBus
[CombatContext] Registered service: CameraStateHooks
[CombatArena] UI Models initialized
[CombatArena] Services registered: 18
[CombatArena] Loaded scenario: 4 combatants
[CombatArena] Loaded scenario from: res://Data/Scenarios/ff_short_attrition.json
[CombatArena] Registered default abilities: basic_attack, ranged_attack, power_strike
[CombatArena] Instantiating visual from scene for Frontline Cleric
[CombatantVisual] CollisionShape3D found for Frontline Cleric
[CombatantVisual] Frontline Cleric initialized - Layer: 2, Mask: 0, Pickable: True, HasShape: True
[CombatArena] Spawned visual for Frontline Cleric at (-4, 0, 0), Layer: 2, InTree: True
[CombatArena] Instantiating visual from scene for Templar Blade
[CombatantVisual] CollisionShape3D found for Templar Blade
[CombatantVisual] Templar Blade initialized - Layer: 2, Mask: 0, Pickable: True, HasShape: True
[CombatArena] Spawned visual for Templar Blade at (-2, 0, -2), Layer: 2, InTree: True
[CombatArena] Instantiating visual from scene for Ravager
[CombatantVisual] CollisionShape3D found for Ravager
[CombatantVisual] Ravager initialized - Layer: 2, Mask: 0, Pickable: True, HasShape: True
[CombatArena] Spawned visual for Ravager at (3, 0, -1), Layer: 2, InTree: True
[CombatArena] Instantiating visual from scene for Pyromancer
[CombatantVisual] CollisionShape3D found for Pyromancer
[CombatantVisual] Pyromancer initialized - Layer: 2, Mask: 0, Pickable: True, HasShape: True
[CombatArena] Spawned visual for Pyromancer at (5, 0, 1), Layer: 2, InTree: True
[AutoBattleWatchdog] Ready
[AutoBattleWatchdog] Monitoring STARTED (freeze: 20s, loop: 20 in 1s)
[AutoBattleRuntime] Monitoring started (seed=42, scenario=res://Data/Scenarios/ff_short_attrition.json)
[CombatArena] [STATE] NotInCombat -> CombatStart
[CombatArena] [TURN] Round 1, Ravager
[CombatArena] [STATE] CombatStart -> TurnStart
[CombatArena] Round 1: Reset reactions for all combatants
[CombatArena] [STATE] TurnStart -> AIDecision
[CombatArena] Camera panning to Ravager at (3, 0, -1)
[CombatArena] SelectCombatant called: enemy_berzerk
[CombatArena] Selected: enemy_berzerk
[CombatArena] Turn started: Ravager (AI)
[CombatArena] === COMBAT ARENA READY ===
[CombatHUD] DeferredInit called - _disposed=False, IsValid=True, InTree=True
[CombatHUD] DeferredInit proceeding with setup
[CombatHUD] === NEW BG3-STYLE HUD SETUP ===
[CombatHUD] MouseFilter set to: Ignore
[CombatHUD] Top bar: (1152, 70) at (0, 0)
[CombatHUD] Hotbar panel created
[CombatHUD] Created ability button 0 with MouseFilter: Stop
[CombatHUD] Created ability button 1 with MouseFilter: Stop
[CombatHUD] Created ability button 2 with MouseFilter: Stop
[CombatHUD] Created ability button 3 with MouseFilter: Stop
[CombatHUD] Created ability button 4 with MouseFilter: Stop
[CombatHUD] Created ability button 5 with MouseFilter: Stop
[CombatHUD] Created ability button 6 with MouseFilter: Stop
[CombatHUD] Created ability button 7 with MouseFilter: Stop
[CombatHUD] Created ability button 8 with MouseFilter: Stop
[CombatHUD] Created ability button 9 with MouseFilter: Stop
[CombatHUD] Created ability button 10 with MouseFilter: Stop
[CombatHUD] Created ability button 11 with MouseFilter: Stop
[CombatHUD] End Turn button created
[CombatHUD] Combat log panel created
[CombatHUD] Character portrait panel created
[UIAwareAI] Ready
[UIAwareAI] Subscribed to state machine
[UIAwareAI] Attached to CombatArena
[CombatHUD] END TURN Debug:
  Position: (1020, 572)
  Size: (120, 60)
  GlobalPosition: (1020, 572)
  Visible: True
  IsInsideTree: True
  Anchors: L=1, R=1, T=1, B=1
  Offsets: L=-132, R=-12, T=-76, B=-16
[UIAwareAI] Processing ENABLED
[CombatArena] UI-aware AI autoplay ENABLED for all factions (full-fidelity mode)
[UIAwareAI] HUD components verified
[UIAwareAI] HUD is ready
[AutoBattleRuntime] Connected to UIAwareAIController events (deferred)
[UIAwareAI] Turn started for Ravager (waited 1.27s total)
[UIAwareAI] Ravager -> EndTurn (#1) score:0.11
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [TURN] Round 1, Templar Blade
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> PlayerDecision
[UIAwareAI] State: TurnStart -> PlayerDecision
[CombatArena] Camera panning to Templar Blade at (-2, 0, -2)
[CombatArena] SelectCombatant called: player_blade
[CombatArena] Selected: player_blade
[CombatArena] Turn started: Templar Blade (Player)
[UIAwareAI] Turn started for Templar Blade (waited 0.27s total)
[UIAwareAI] Templar Blade -> EndTurn (#1) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] PlayerDecision -> TurnEnd
[UIAwareAI] State: PlayerDecision -> TurnEnd
[CombatArena] [TURN] Round 1, Pyromancer
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> AIDecision
[UIAwareAI] State: TurnStart -> AIDecision
[CombatArena] Camera panning to Pyromancer at (5, 0, 1)
[CombatArena] SelectCombatant called: enemy_pyromancer
[CombatArena] Selected: enemy_pyromancer
[CombatArena] Turn started: Pyromancer (AI)
[UIAwareAI] Turn started for Pyromancer (waited 0.27s total)
[UIAwareAI] Pyromancer -> UseAbility (#1) score:15.93
[CombatArena] ExecuteAbilityAtPosition: enemy_pyromancer -> fireball @ (-3, 0, -1)
[CombatArena] ExecuteAbility starting with action ID 1
[CombatArena] [STATE] AIDecision -> ActionExecution
[UIAwareAI] State: AIDecision -> ActionExecution
[CombatArena] Pyromancer used fireball on Frontline Cleric, Templar Blade: damage:15, damage:20
[CombatArena] ClearSelection called
[UIAwareAI] [DIAG] state=ActionExecution, waiting_for=animation to complete (1 playing), isActing=False, hudReady=True, timeSinceStateChange=0.0000, elapsedSinceLastAction=0.0000, nextActionDelay=0.8664, actionsTaken=1, timelines=1, actor=enemy_pyromancer(True), cooldown_check=0.0010<0.8664=True
[CombatArena] [STATE] ActionExecution -> AIDecision
[UIAwareAI] State: ActionExecution -> AIDecision
[CombatArena] Ignoring stale callback (action 1 vs executing -1): Ability timeline timeout fallback
[UIAwareAI] Pyromancer -> EndTurn (#2) score:0.11
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [TURN] Round 1, Frontline Cleric
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> PlayerDecision
[UIAwareAI] State: TurnStart -> PlayerDecision
[CombatArena] Camera panning to Frontline Cleric at (-4, 0, 0)
[CombatArena] SelectCombatant called: player_cleric
[CombatArena] Selected: player_cleric
[CombatArena] Turn started: Frontline Cleric (Player)
[UIAwareAI] Turn started for Frontline Cleric (waited 2.05s total)
[UIAwareAI] Frontline Cleric -> UseAbility (#1) score:2.53
[CombatArena] ExecuteAbility (auto-target): player_cleric -> battle_cry
[CombatArena] ExecuteAbility starting with action ID 2
[CombatArena] [STATE] PlayerDecision -> ActionExecution
[UIAwareAI] State: PlayerDecision -> ActionExecution
[CombatArena] [STATUS] Inspired applied to player_blade
[CombatArena] Frontline Cleric used battle_cry on Templar Blade: apply_status:0
[CombatArena] ClearSelection called
[CombatArena] [STATE] ActionExecution -> PlayerDecision
[UIAwareAI] State: ActionExecution -> PlayerDecision
[CombatArena] Ignoring stale callback (action 2 vs executing -1): Ability timeline timeout fallback
[UIAwareAI] [DIAG] state=PlayerDecision, waiting_for=action cooldown (0.7s remaining), isActing=False, hudReady=True, timeSinceStateChange=0.8708, elapsedSinceLastAction=0.5958, nextActionDelay=1.3032, actionsTaken=1, timelines=0, actor=player_cleric(True), cooldown_check=0.5968<1.3032=True
[UIAwareAI] Frontline Cleric -> UseAbility (#2) score:2.33
[CombatArena] ExecuteAbility: player_cleric -> heal_wounds -> player_blade
[CombatArena] ExecuteAbility starting with action ID 3
[CombatArena] [STATE] PlayerDecision -> ActionExecution
[UIAwareAI] State: PlayerDecision -> ActionExecution
[CombatArena] Frontline Cleric used heal_wounds on Templar Blade: heal:11
[CombatArena] ClearSelection called
[CombatArena] [STATE] ActionExecution -> PlayerDecision
[UIAwareAI] State: ActionExecution -> PlayerDecision
[CombatArena] Ignoring stale callback (action 3 vs executing -1): Ability timeline timeout fallback
[UIAwareAI] Frontline Cleric -> EndTurn (#3) score:0.11
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] PlayerDecision -> TurnEnd
[UIAwareAI] State: PlayerDecision -> TurnEnd
[CombatArena] [TURN] Round 2, Ravager
[CombatArena] [STATE] TurnEnd -> RoundEnd
[UIAwareAI] State: TurnEnd -> RoundEnd
[CombatArena] [STATE] RoundEnd -> TurnStart
[UIAwareAI] State: RoundEnd -> TurnStart
[CombatArena] Round 2: Reset reactions for all combatants
[CombatArena] [STATE] TurnStart -> AIDecision
[UIAwareAI] State: TurnStart -> AIDecision
[CombatArena] Camera panning to Ravager at (3, 0, -1)
[CombatArena] SelectCombatant called: enemy_berzerk
[CombatArena] Selected: enemy_berzerk
[CombatArena] Turn started: Ravager (AI)
[UIAwareAI] [DIAG] state=AIDecision, waiting_for=state to settle (0.2s remaining), isActing=False, hudReady=True, timeSinceStateChange=0.0917, elapsedSinceLastAction=1.3338, nextActionDelay=1.2931, actionsTaken=3, timelines=0, actor=enemy_berzerk(True), cooldown_check=1.3348<1.2931=False
[UIAwareAI] Turn started for Ravager (waited 4.57s total)
[UIAwareAI] Ravager -> EndTurn (#1) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [TURN] Round 2, Templar Blade
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> PlayerDecision
[UIAwareAI] State: TurnStart -> PlayerDecision
[CombatArena] Camera panning to Templar Blade at (-2, 0, -2)
[CombatArena] SelectCombatant called: player_blade
[CombatArena] Selected: player_blade
[CombatArena] Turn started: Templar Blade (Player)
[UIAwareAI] Turn started for Templar Blade (waited 0.26s total)
[UIAwareAI] Templar Blade -> EndTurn (#1) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] PlayerDecision -> TurnEnd
[UIAwareAI] State: PlayerDecision -> TurnEnd
[CombatArena] [TURN] Round 2, Pyromancer
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> AIDecision
[UIAwareAI] State: TurnStart -> AIDecision
[CombatArena] Camera panning to Pyromancer at (5, 0, 1)
[CombatArena] SelectCombatant called: enemy_pyromancer
[CombatArena] Selected: enemy_pyromancer
[CombatArena] Turn started: Pyromancer (AI)
[UIAwareAI] Turn started for Pyromancer (waited 0.29s total)
[UIAwareAI] Pyromancer -> UseAbility (#1) score:15.69
[CombatArena] ExecuteAbilityAtPosition: enemy_pyromancer -> fireball @ (-4, 0, 0)
[CombatArena] ExecuteAbility starting with action ID 4
[CombatArena] [STATE] AIDecision -> ActionExecution
[UIAwareAI] State: AIDecision -> ActionExecution
[CombatArena] Pyromancer used fireball on Frontline Cleric, Templar Blade: damage:19, damage:19
[CombatArena] ClearSelection called
[CombatArena] [STATE] ActionExecution -> AIDecision
[UIAwareAI] State: ActionExecution -> AIDecision
[CombatArena] Ignoring stale callback (action 4 vs executing -1): Ability timeline timeout fallback
[UIAwareAI] [DIAG] state=AIDecision, waiting_for=action cooldown (0.1s remaining), isActing=False, hudReady=True, timeSinceStateChange=1.5545, elapsedSinceLastAction=1.2681, nextActionDelay=1.3917, actionsTaken=1, timelines=0, actor=enemy_pyromancer(True), cooldown_check=1.2691<1.3917=True
[UIAwareAI] Pyromancer -> EndTurn (#2) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [TURN] Round 2, Frontline Cleric
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> PlayerDecision
[UIAwareAI] State: TurnStart -> PlayerDecision
[CombatArena] Camera panning to Frontline Cleric at (-4, 0, 0)
[CombatArena] SelectCombatant called: player_cleric
[CombatArena] Selected: player_cleric
[CombatArena] Turn started: Frontline Cleric (Player)
[UIAwareAI] Turn started for Frontline Cleric (waited 2.51s total)
[UIAwareAI] Frontline Cleric -> UseAbility (#1) score:8.45
[CombatArena] ExecuteAbility: player_cleric -> heal_wounds -> player_blade
[CombatArena] ExecuteAbility starting with action ID 5
[CombatArena] [STATE] PlayerDecision -> ActionExecution
[UIAwareAI] State: PlayerDecision -> ActionExecution
[CombatArena] Frontline Cleric used heal_wounds on Templar Blade: heal:10
[CombatArena] ClearSelection called
[CombatArena] [STATE] ActionExecution -> PlayerDecision
[UIAwareAI] State: ActionExecution -> PlayerDecision
[CombatArena] Ignoring stale callback (action 5 vs executing -1): Ability timeline timeout fallback
[UIAwareAI] Frontline Cleric -> UseAbility (#2) score:2.48
[CombatArena] ExecuteAbility (auto-target): player_cleric -> battle_cry
[CombatArena] ExecuteAbility starting with action ID 6
[CombatArena] [STATE] PlayerDecision -> ActionExecution
[UIAwareAI] State: PlayerDecision -> ActionExecution
[CombatArena] Frontline Cleric used battle_cry on Templar Blade: apply_status:0
[CombatArena] ClearSelection called
[UIAwareAI] [DIAG] state=ActionExecution, waiting_for=animation to complete (1 playing), isActing=False, hudReady=True, timeSinceStateChange=0.0000, elapsedSinceLastAction=0.0000, nextActionDelay=1.3827, actionsTaken=2, timelines=1, actor=player_cleric(True), cooldown_check=0.0010<1.3827=True
[CombatArena] [STATE] ActionExecution -> PlayerDecision
[UIAwareAI] State: ActionExecution -> PlayerDecision
[CombatArena] Ignoring stale callback (action 6 vs executing -1): Ability timeline timeout fallback
[UIAwareAI] Frontline Cleric -> EndTurn (#3) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] PlayerDecision -> TurnEnd
[UIAwareAI] State: PlayerDecision -> TurnEnd
[CombatArena] [TURN] Round 3, Ravager
[CombatArena] [STATE] TurnEnd -> RoundEnd
[UIAwareAI] State: TurnEnd -> RoundEnd
[CombatArena] [STATE] RoundEnd -> TurnStart
[UIAwareAI] State: RoundEnd -> TurnStart
[CombatArena] Round 3: Reset reactions for all combatants
[CombatArena] [STATE] TurnStart -> AIDecision
[UIAwareAI] State: TurnStart -> AIDecision
[CombatArena] Camera panning to Ravager at (3, 0, -1)
[CombatArena] SelectCombatant called: enemy_berzerk
[CombatArena] Selected: enemy_berzerk
[CombatArena] Turn started: Ravager (AI)
[UIAwareAI] Turn started for Ravager (waited 4.52s total)
[UIAwareAI] Ravager -> EndTurn (#1) score:0.11
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [TURN] Round 3, Templar Blade
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> PlayerDecision
[UIAwareAI] State: TurnStart -> PlayerDecision
[CombatArena] Camera panning to Templar Blade at (-2, 0, -2)
[CombatArena] SelectCombatant called: player_blade
[CombatArena] Selected: player_blade
[CombatArena] Turn started: Templar Blade (Player)
[UIAwareAI] Turn started for Templar Blade (waited 0.28s total)
[UIAwareAI] Templar Blade -> EndTurn (#1) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] PlayerDecision -> TurnEnd
[UIAwareAI] State: PlayerDecision -> TurnEnd
[CombatArena] [TURN] Round 3, Pyromancer
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> AIDecision
[UIAwareAI] State: TurnStart -> AIDecision
[CombatArena] Camera panning to Pyromancer at (5, 0, 1)
[CombatArena] SelectCombatant called: enemy_pyromancer
[CombatArena] Selected: enemy_pyromancer
[CombatArena] Turn started: Pyromancer (AI)
[UIAwareAI] Turn started for Pyromancer (waited 0.26s total)
[UIAwareAI] Pyromancer -> UseAbility (#1) score:15.93
[CombatArena] ExecuteAbilityAtPosition: enemy_pyromancer -> fireball @ (-2, 0, -2)
[CombatArena] ExecuteAbility starting with action ID 7
[CombatArena] [STATE] AIDecision -> ActionExecution
[UIAwareAI] State: AIDecision -> ActionExecution
[CombatArena] Pyromancer used fireball on Frontline Cleric, Templar Blade: damage:19, damage:21
[CombatArena] ClearSelection called
[UIAwareAI] [DIAG] state=ActionExecution, waiting_for=animation to complete (1 playing), isActing=False, hudReady=True, timeSinceStateChange=0.0000, elapsedSinceLastAction=0.0000, nextActionDelay=1.2955, actionsTaken=1, timelines=1, actor=enemy_pyromancer(True), cooldown_check=0.0010<1.2955=True
[CombatArena] [STATE] ActionExecution -> AIDecision
[UIAwareAI] State: ActionExecution -> AIDecision
[CombatArena] Ignoring stale callback (action 7 vs executing -1): Ability timeline timeout fallback
[UIAwareAI] Pyromancer -> EndTurn (#2) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [TURN] Round 4, Ravager
[CombatArena] [STATE] TurnEnd -> RoundEnd
[UIAwareAI] State: TurnEnd -> RoundEnd
[CombatArena] [STATE] RoundEnd -> TurnStart
[UIAwareAI] State: RoundEnd -> TurnStart
[CombatArena] Round 4: Reset reactions for all combatants
[CombatArena] [STATE] TurnStart -> AIDecision
[UIAwareAI] State: TurnStart -> AIDecision
[CombatArena] Camera panning to Ravager at (3, 0, -1)
[CombatArena] SelectCombatant called: enemy_berzerk
[CombatArena] Selected: enemy_berzerk
[CombatArena] Turn started: Ravager (AI)
[UIAwareAI] Turn started for Ravager (waited 2.42s total)
[UIAwareAI] Ravager -> EndTurn (#1) score:0.11
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [TURN] Round 4, Templar Blade
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> PlayerDecision
[UIAwareAI] State: TurnStart -> PlayerDecision
[CombatArena] Camera panning to Templar Blade at (-2, 0, -2)
[CombatArena] SelectCombatant called: player_blade
[CombatArena] Selected: player_blade
[CombatArena] Turn started: Templar Blade (Player)
[UIAwareAI] Turn started for Templar Blade (waited 0.27s total)
[UIAwareAI] Templar Blade -> EndTurn (#1) score:0.11
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] PlayerDecision -> TurnEnd
[UIAwareAI] State: PlayerDecision -> TurnEnd
[CombatArena] [TURN] Round 4, Pyromancer
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> AIDecision
[UIAwareAI] State: TurnStart -> AIDecision
[CombatArena] Camera panning to Pyromancer at (5, 0, 1)
[CombatArena] SelectCombatant called: enemy_pyromancer
[CombatArena] Selected: enemy_pyromancer
[CombatArena] Turn started: Pyromancer (AI)
[UIAwareAI] Turn started for Pyromancer (waited 0.27s total)
[UIAwareAI] Pyromancer -> UseAbility (#1) score:7.27
[CombatArena] ExecuteAbilityAtPosition: enemy_pyromancer -> fireball @ (-2, 0, -2)
[CombatArena] ExecuteAbility starting with action ID 8
[CombatArena] [STATE] AIDecision -> ActionExecution
[UIAwareAI] State: AIDecision -> ActionExecution
[CombatArena] Pyromancer used fireball on Templar Blade: damage:16
[CombatArena] ClearSelection called
[UIAwareAI] [DIAG] state=ActionExecution, waiting_for=animation to complete (1 playing), isActing=False, hudReady=True, timeSinceStateChange=0.0000, elapsedSinceLastAction=0.0000, nextActionDelay=1.1012, actionsTaken=1, timelines=1, actor=enemy_pyromancer(True), cooldown_check=0.0010<1.1012=True
[CombatArena] [STATE] ActionExecution -> AIDecision
[UIAwareAI] State: ActionExecution -> AIDecision
[CombatArena] Ignoring stale callback (action 8 vs executing -1): Ability timeline timeout fallback
[UIAwareAI] Pyromancer -> EndTurn (#2) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [TURN] Round 5, Ravager
[CombatArena] [STATE] TurnEnd -> RoundEnd
[UIAwareAI] State: TurnEnd -> RoundEnd
[CombatArena] [STATE] RoundEnd -> TurnStart
[UIAwareAI] State: RoundEnd -> TurnStart
[CombatArena] Round 5: Reset reactions for all combatants
[CombatArena] [STATE] TurnStart -> AIDecision
[UIAwareAI] State: TurnStart -> AIDecision
[CombatArena] Camera panning to Ravager at (3, 0, -1)
[CombatArena] SelectCombatant called: enemy_berzerk
[CombatArena] Selected: enemy_berzerk
[CombatArena] Turn started: Ravager (AI)
[UIAwareAI] Turn started for Ravager (waited 2.21s total)
[UIAwareAI] Ravager -> EndTurn (#1) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [TURN] Round 5, Templar Blade
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> PlayerDecision
[UIAwareAI] State: TurnStart -> PlayerDecision
[CombatArena] Camera panning to Templar Blade at (-2, 0, -2)
[CombatArena] SelectCombatant called: player_blade
[CombatArena] Selected: player_blade
[CombatArena] Turn started: Templar Blade (Player)
[UIAwareAI] Turn started for Templar Blade (waited 0.26s total)
[UIAwareAI] Templar Blade -> EndTurn (#1) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] PlayerDecision -> TurnEnd
[UIAwareAI] State: PlayerDecision -> TurnEnd
[CombatArena] [TURN] Round 5, Pyromancer
[CombatArena] [STATE] TurnEnd -> TurnStart
[UIAwareAI] State: TurnEnd -> TurnStart
[CombatArena] [STATE] TurnStart -> AIDecision
[UIAwareAI] State: TurnStart -> AIDecision
[CombatArena] Camera panning to Pyromancer at (5, 0, 1)
[CombatArena] SelectCombatant called: enemy_pyromancer
[CombatArena] Selected: enemy_pyromancer
[CombatArena] Turn started: Pyromancer (AI)
[UIAwareAI] Turn started for Pyromancer (waited 0.27s total)
[UIAwareAI] Pyromancer -> UseAbility (#1) score:7.75
[CombatArena] ExecuteAbilityAtPosition: enemy_pyromancer -> fireball @ (-2, 0, -2)
[CombatArena] ExecuteAbility starting with action ID 9
[CombatArena] [STATE] AIDecision -> ActionExecution
[UIAwareAI] State: AIDecision -> ActionExecution
[CombatArena] Pyromancer used fireball on Templar Blade: damage:18
[CombatArena] ClearSelection called
[CombatArena] === COMBAT ENDED: Defeat! ===
[UIAwareAI] [DIAG] state=ActionExecution, waiting_for=animation to complete (1 playing), isActing=False, hudReady=True, timeSinceStateChange=0.0000, elapsedSinceLastAction=0.0000, nextActionDelay=1.2036, actionsTaken=1, timelines=1, actor=enemy_pyromancer(True), cooldown_check=0.0010<1.2036=True
[CombatArena] [STATE] ActionExecution -> AIDecision
[UIAwareAI] State: ActionExecution -> AIDecision
[CombatArena] Ignoring stale callback (action 9 vs executing -1): Ability timeline timeout fallback
[UIAwareAI] Pyromancer -> EndTurn (#2) score:0.10
[UIAwareAI] Calling EndCurrentTurn()
[CombatArena] [STATE] AIDecision -> TurnEnd
[UIAwareAI] State: AIDecision -> TurnEnd
[CombatArena] [STATE] TurnEnd -> CombatEnd
[AutoBattleWatchdog] Monitoring STOPPED

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë             AUTO-BATTLE RESULTS                   ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

  Winner:       Hostile
  Total Turns:  17
  Total Rounds: 5
  Duration:     26012ms
  Completed:    True
  End Reason:   combat_complete
  Seed:         42

  Surviving Units:
    - Ravager (enemy_berzerk) HP:72/72
    - Pyromancer (enemy_pyromancer) HP:30/50

AUTO-BATTLE: OK
[UIAwareAI] State: TurnEnd -> CombatEnd
[UIAwareAI] Processing DISABLED
[CombatArena] === COMBAT ENDED: Defeat! ===
[0;36m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê[0m
[0;32m[INFO][0m Auto-battle PASSED
[0;32m[INFO][0m Combat log: artifacts/autobattle/ff_ff_short_attrition.jsonl (139 entries, 28K)
